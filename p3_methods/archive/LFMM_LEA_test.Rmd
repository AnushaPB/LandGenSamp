---
title: "LFMM_LEA_test"
output: html_document
---

```{r}
library("LEA")
```

```{r}
#create temporary file with genotypes
write.geno(subgen, here("data","temp_genotypes.geno"))
  
#Estimate admixture coefficients using sparse Non-Negative Matrix Factorization algorithms,
#Code for testing multiple K values:
maxK <- 10
obj.snmf <- snmf(here("data","temp_genotypes.geno"), K = 1:maxK, ploidy = 2, entropy = T, alpha = 100, project = "new")

plot(obj.snmf)

```
```{r}
X = as.matrix(subgsd_df[,c("env1", "env2")])
Y = subgen[,1:8]
mod <- lfmm2(input = Y, env = X, K = 2)
pv <- lfmm2.test(object = mod,
                 input = Y,
                 env = X,
                 linear = TRUE)



plot(-log10(pv$pvalues), col = "grey", cex = .6, pch = 19)
points(target, -log10(pv$pvalues[target]), col = "red")

```

